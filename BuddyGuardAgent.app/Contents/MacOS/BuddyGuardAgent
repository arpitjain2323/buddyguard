#!/bin/bash
# Launcher run inside the .app so the agent runs in the user's graphical session (needed for Screen Recording when started via LaunchAgent).
# From .../BuddyGuardAgent.app/Contents/MacOS/BuddyGuardAgent -> project root (parent of .app)
ROOT="$(cd "$(dirname "$0")/../../.." && pwd)"
export PYTHONPATH="$ROOT"
exec >> /tmp/teenmonitor-agent.log 2>> /tmp/teenmonitor-agent.err
# On Apple Silicon, force native arm64 so PIL/venv match (avoids Rosetta x86_64 mismatch)
if [ "$(uname -m)" = "arm64" ]; then
  exec arch -arm64 "$ROOT/venv/bin/python" -m agent.agent
else
  exec "$ROOT/venv/bin/python" -m agent.agent
fi
