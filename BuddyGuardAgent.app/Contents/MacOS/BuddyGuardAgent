#!/bin/bash
# Launcher run inside the .app so the agent runs in the user's graphical session (needed for Screen Recording when started via LaunchAgent).
# From .../BuddyGuardAgent.app/Contents/MacOS/BuddyGuardAgent -> project root (parent of .app)
ROOT="$(cd "$(dirname "$0")/../../.." && pwd)"
export PYTHONPATH="$ROOT"
exec >> /tmp/teenmonitor-agent.log 2>> /tmp/teenmonitor-agent.err
# On Apple Silicon, always run Python as arm64 (even if this script is running under Rosetta as x86_64)
if arch -arm64 true 2>/dev/null; then
  exec arch -arm64 "$ROOT/venv/bin/python" -m agent.agent
else
  exec "$ROOT/venv/bin/python" -m agent.agent
fi
